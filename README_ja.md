# TensorLogic

Apple Siliconå‘ã‘ã®æœ¬æ ¼çš„ãªf16ãƒ†ãƒ³ã‚½ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚è‡ªå‹•å¾®åˆ†ã¨æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ­è¼‰ã—ã€Metal GPUã¨Neural Engineã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾å¿œã€‚

> **âš ï¸ å®Ÿé¨“çš„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦**
>
> ã“ã‚Œã¯ä»¥ä¸‹ã®åˆ¶ç´„ãŒã‚ã‚‹**å®Ÿé¨“çš„ç ”ç©¶ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ã§ã™:
> - **Apple Siliconã®ã¿**: M-seriesãƒãƒƒãƒ—ï¼ˆM1/M2/M3/M4ï¼‰æ­è¼‰ã®macOSãŒå¿…è¦
> - **f16ï¼ˆåŠç²¾åº¦ï¼‰ã®ã¿**: ã™ã¹ã¦ã®æµ®å‹•å°æ•°ç‚¹æ¼”ç®—ã¯16ãƒ“ãƒƒãƒˆæµ®å‹•å°æ•°ç‚¹ã®ã¿ã‚’ä½¿ç”¨
> - **Metalãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯å¿…é ˆ**: GPUã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯Appleã®Metalãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«ä¾å­˜
>
> Appleè£½å“ä»¥å¤–ã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚„æ±Žç”¨ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ã®æœ¬ç•ªåˆ©ç”¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã›ã‚“ã€‚

## æ¦‚è¦

TensorLogicã¯ã€Apple Siliconï¼ˆM-seriesãƒãƒƒãƒ—ï¼‰å°‚ç”¨ã«è¨­è¨ˆã•ã‚ŒãŸçµ±åˆãƒ†ãƒ³ã‚½ãƒ«ä»£æ•°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€CoreMLã‚’ä»‹ã—ã¦Metal GPUã¨Neural Engineã®ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªçµ±åˆã‚’æä¾›ã—ã¾ã™ã€‚ã™ã¹ã¦ã®æ¼”ç®—ã¯æœ€é©ãªNeural Engineäº’æ›æ€§ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã®ãŸã‚ã«f16ï¼ˆåŠç²¾åº¦ï¼‰ã‚’ç¶­æŒã—ã¾ã™ã€‚

**ðŸ“š [å…¥é–€ã‚¬ã‚¤ãƒ‰](claudedocs/getting_started.md)** | **ðŸ“– [ã‚ªãƒ—ãƒ†ã‚£ãƒžã‚¤ã‚¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«](claudedocs/optimizer_tutorial.md)** | **ðŸ”§ [å®Œå…¨ä»•æ§˜](claudedocs/f16_neural_engine_metal_spec.md)**

**ðŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [English](README.md) | [æ—¥æœ¬èªž](README_ja.md)

## ä¸»ãªæ©Ÿèƒ½

### âœ… æœ¬ç•ªç’°å¢ƒå¯¾å¿œ

- **ãƒ†ãƒ³ã‚½ãƒ«æ¼”ç®—** (Phase 1-3)
  - è¦ç´ ã”ã¨ã®æ¼”ç®—: add, sub, mul, div
  - GPUæœ€é©åŒ–ã•ã‚ŒãŸè¡Œåˆ—ä¹—ç®—
  - æ´»æ€§åŒ–é–¢æ•°: ReLU, GELU, Softmax
  - ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆï¼ˆNumPyäº’æ›ï¼‰
  - ãƒªãƒ€ã‚¯ã‚·ãƒ§ãƒ³: sum, mean, max, minï¼ˆå…¨ä½“ãŠã‚ˆã³æ¬¡å…ƒæŒ‡å®šï¼‰
  - Einsteinã®è¦ç´„ã«ã‚ˆã‚‹æœ€é©åŒ–
  - ãƒ¡ãƒ¢ãƒªåŠ¹çŽ‡ã®ãŸã‚ã®ã‚¤ãƒ³ãƒ—ãƒ¬ãƒ¼ã‚¹æ¼”ç®—

- **è‡ªå‹•å¾®åˆ†** (Phase 5-6) âš¡
  - å‹•çš„è¨ˆç®—ã‚°ãƒ©ãƒ•ï¼ˆPyTorchã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
  - å®Œå…¨ãªé€†ä¼æ’­å®Ÿè£…
  - ã™ã¹ã¦ã®æ¼”ç®—ã®å‹¾é…è¨ˆç®—
  - äºŒéšŽå¾®åˆ†ï¼ˆãƒ˜ãƒƒã‚»è¡Œåˆ—ã®åŸºç¤Žï¼‰
  - æ•°å€¤æ¤œè¨¼ã«ã‚ˆã‚‹å‹¾é…ãƒã‚§ãƒƒã‚¯
  - é«˜éšŽå¾®åˆ†ã®ãŸã‚ã®ã‚°ãƒ©ãƒ•ä½œæˆãƒ¢ãƒ¼ãƒ‰

- **æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ** (Phase 9.1) ðŸš€ NEW
  - **SGD**: åŸºæœ¬çš„ãªå‹¾é…é™ä¸‹æ³•ã€ãƒ¢ãƒ¡ãƒ³ã‚¿ãƒ ã€Nesterov
  - **Adam**: AMSGradã‚µãƒãƒ¼ãƒˆä»˜ãé©å¿œå­¦ç¿’çŽ‡
  - **AdamW**: ã‚ˆã‚Šè‰¯ã„æ­£å‰‡åŒ–ã®ãŸã‚ã®åˆ†é›¢é‡ã¿æ¸›è¡°
  - å­¦ç¿’çŽ‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°
  - ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã®ãŸã‚ã®çŠ¶æ…‹ä¿å­˜/èª­ã¿è¾¼ã¿
  - è¤‡æ•°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã‚µãƒãƒ¼ãƒˆ

- **ãƒ‡ãƒã‚¤ã‚¹ã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** (Phase 2, 4, 7)
  - ã™ã¹ã¦ã®æ¼”ç®—ã§Metal GPUã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
  - Neural Engineçµ±åˆï¼ˆåŸºç›¤å®Œæˆï¼‰
  - ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼Metal â†” Neural Engineå¤‰æ›
  - ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–ã®ãŸã‚ã®ãƒãƒƒãƒ•ã‚¡ãƒ—ãƒ¼ãƒªãƒ³ã‚°
  - èžåˆæ¼”ç®—ï¼ˆadd+relu, mul+relu, affineï¼‰
  - Metal GPUå‹¾é…ã‚«ãƒ¼ãƒãƒ«
  - è‡ªå‹•ãƒ‡ãƒã‚¤ã‚¹é¸æŠžã®ãŸã‚ã®ExecutionPlanner

- **Pythonçµ±åˆ** (Phase 1-3) ðŸ NEW
  - Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ: `python import numpy as np`
  - Pythoné–¢æ•°å‘¼ã³å‡ºã—: `python.call("np.sum", x)`
  - ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªTensor â†” NumPyå¤‰æ›ï¼ˆf16 â†” f32ï¼‰
  - NumPyã€PyTorchã€SciKit-Learnçµ±åˆ
  - PyO3ã«ã‚ˆã‚‹Pythonãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
  - Jupyterå¯¾å¿œã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ðŸš§ é«˜åº¦ãªæ©Ÿèƒ½ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

- **Neural EngineæŽ¨è«–**: å®Œå…¨ãªCoreMLãƒ¢ãƒ‡ãƒ«çµ±åˆï¼ˆåŸºç›¤å®Œæˆã€å»¶æœŸï¼‰
- **å­¦ç¿’çŽ‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©**: ã‚³ã‚µã‚¤ãƒ³ã€ã‚¹ãƒ†ãƒƒãƒ—æ¸›è¡°ã€ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—ï¼ˆè¿‘æ—¥å…¬é–‹ï¼‰
- **è¿½åŠ ã®æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: RMSpropã€Adagradï¼ˆå°†æ¥ã®ä½œæ¥­ï¼‰

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

åŒ…æ‹¬çš„ãªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«ã¤ã„ã¦ã¯ã€[**å…¥é–€ã‚¬ã‚¤ãƒ‰**](claudedocs/getting_started.md)ã‚’ã”è¦§ãã ã•ã„ã€‚

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: CLIãƒã‚¤ãƒŠãƒª**

TensorLogicã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ã‚’ãƒã‚¤ãƒŠãƒªã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:

```bash
cargo install --git https://github.com/JunSuzukiJapan/tensorlogic.git
```

ã“ã‚Œã«ã‚ˆã‚Š`tl`ã‚³ãƒžãƒ³ãƒ‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚

ã¾ãŸã¯ã‚½ãƒ¼ã‚¹ã‹ã‚‰ãƒ“ãƒ«ãƒ‰:

```bash
git clone https://github.com/JunSuzukiJapan/tensorlogic.git
cd tensorlogic
cargo build --release
# ãƒã‚¤ãƒŠãƒªã¯: target/release/tl
```

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«** ðŸ NEW

TensorLogicã‚’Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:

```bash
# maturinã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install maturin

# wheelã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
git clone https://github.com/JunSuzukiJapan/tensorlogic.git
cd tensorlogic
maturin build --features python-extension --release
pip install target/wheels/tensorlogic-*.whl
```

Pythonã§ä½¿ç”¨:

```python
import tensorlogic as tl
import numpy as np

# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ã‚’ä½œæˆ
interp = tl.Interpreter()

# TensorLogicã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
interp.execute("""
    main {
        python import numpy as np

        tensor x: float16[3] = [1.0, 2.0, 3.0]
        tensor sum_x: float16[1] = python.call("np.sum", x)

        print("Sum:", sum_x)
    }
""")
# å‡ºåŠ›: âœ“ Python import: numpy (as np)
#       Sum: [6.0000]
```

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

TensorLogicã¯ã€ãƒ†ãƒ³ã‚½ãƒ«æ¼”ç®—ã¨ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿åž‹è¨€èªžã§ã™ã€‚

#### 1. ãƒ†ãƒ³ã‚½ãƒ«å®£è¨€

`float16`åž‹ã§ãƒ†ãƒ³ã‚½ãƒ«ã‚’å®£è¨€ï¼ˆTensorLogicã¯GPUåŠ¹çŽ‡ã®ãŸã‚ã«16ãƒ“ãƒƒãƒˆæµ®å‹•å°æ•°ç‚¹ã‚’ä½¿ç”¨ï¼‰:

```tensorlogic
// ã‚¹ã‚«ãƒ©ãƒ¼ãƒ†ãƒ³ã‚½ãƒ«
tensor x: float16[1] = [2.0]

// ãƒ™ã‚¯ãƒˆãƒ«ãƒ†ãƒ³ã‚½ãƒ«
tensor v: float16[3] = [1.0, 2.0, 3.0]

// è¡Œåˆ—ãƒ†ãƒ³ã‚½ãƒ«
tensor W: float16[2, 3] = [[1.0, 2.0, 3.0],
                           [4.0, 5.0, 6.0]]

// å­¦ç¿’å¯èƒ½ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç”¨ï¼‰
tensor w: float16[1] learnable = [0.5]
```

#### 2. ãƒ†ãƒ³ã‚½ãƒ«æ¼”ç®—

è¦ç´ ã”ã¨ã®æ¼”ç®—ã¨è¡Œåˆ—æ¼”ç®—:

```tensorlogic
main {
    // è¦ç´ ã”ã¨ã®æ¼”ç®—
    result := a + b      // åŠ ç®—
    result := a - b      // æ¸›ç®—
    result := a * b      // ä¹—ç®—
    result := a / b      // é™¤ç®—

    // è¡Œåˆ—æ¼”ç®—
    result := A @ B      // è¡Œåˆ—ä¹—ç®—
    result := a ** 2     // ã¹ãä¹—

    // æ´»æ€§åŒ–é–¢æ•°
    result := relu(x)
    result := gelu(x)

    // ãƒªãƒ€ã‚¯ã‚·ãƒ§ãƒ³
    sum := sum(tensor)
    mean := mean(tensor)
}
```

#### 3. å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

ä»–ã®TensorLogicãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å®£è¨€ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ:

```tensorlogic
// åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ†ãƒ³ã‚½ãƒ«ã¨é–¢æ•°å®šç¾©ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import "path/to/module.tl"

main {
    // ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸãƒ†ãƒ³ã‚½ãƒ«ã¨é–¢æ•°ã‚’ä½¿ç”¨
    result := imported_tensor * 2
}
```

**æ©Ÿèƒ½**:
- ç›¸å¯¾ãƒ‘ã‚¹è§£æ±ºï¼ˆã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ï¼‰
- é‡è¤‡ã‚¤ãƒ³ãƒãƒ¼ãƒˆé˜²æ­¢ï¼ˆåŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã¯2å›žã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œãªã„ï¼‰
- ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯å®Ÿè¡Œãªã—ï¼ˆå®£è¨€ã®ã¿ãŒã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ï¼‰
- å¾ªç’°ä¾å­˜æ¤œå‡º

**ä¾‹**: [examples/import_test/](examples/import_test/)ã‚’å‚ç…§

#### 4. åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼

æ¡ä»¶åˆ†å²ã¨ãƒ«ãƒ¼ãƒ—:

```tensorlogic
main {
    // ifæ–‡
    if x > 0 {
        y := x * 2
    }

    // if-elseæ–‡
    if x > 0 {
        y := x * 2
    } else {
        y := x * 0.5
    }

    // forãƒ«ãƒ¼ãƒ—
    for i in 0..10 {
        x := x + i
    }

    // whileãƒ«ãƒ¼ãƒ—
    while x < 100 {
        x := x * 1.1
    }
}
```

#### 5. å‹¾é…é™ä¸‹æ³•ã«ã‚ˆã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°

`learn`æ–‡ã‚’ä½¿ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã‚µãƒãƒ¼ãƒˆï¼‰:

```tensorlogic
// å­¦ç¿’å¯èƒ½ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å®£è¨€
tensor W: float16[1] learnable = [0.5]

main {
    // ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿
    tensor x1: float16[1] = [1.0]
    tensor y1: float16[1] = [3.0]
    tensor x2: float16[1] = [-2.0]  // è² ã®æ•°ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™
    tensor y2: float16[1] = [-6.0]

    // learnãƒ–ãƒ­ãƒƒã‚¯ã§ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
    learn {
        // ä¸­é–“è¨ˆç®—ã®ãŸã‚ã®ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°
        pred1 := x1 * W
        pred2 := x2 * W

        // æå¤±ã‚’è¨ˆç®—
        err1 := pred1 - y1
        err2 := pred2 - y2
        loss := err1 * err1 + err2 * err2

        objective: loss,
        optimizer: sgd(lr: 0.01),
        epochs: 100
    }

    print("å­¦ç¿’ã—ãŸW:", W)  // 3.0ã«è¿‘ã„å€¤ã«ãªã‚‹ã¯ãš
}
```

**æ©Ÿèƒ½**:
- **ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°**: `learn`ãƒ–ãƒ­ãƒƒã‚¯å†…ã§`:=`ã‚’ä½¿ç”¨ã—ã¦ä¸­é–“è¨ˆç®—ã‚’è¡Œã†
- **è² ã®æ•°**: è² ã®æ•°å€¤ãƒªãƒ†ãƒ©ãƒ«ã‚’å®Œå…¨ã‚µãƒãƒ¼ãƒˆ
- **è¤‡æ•°ã®æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: SGDã€Adamã€AdamWã¨ã‚«ã‚¹ã‚¿ãƒžã‚¤ã‚ºå¯èƒ½ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

åˆ©ç”¨å¯èƒ½ãªæœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :
- `sgd(lr: 0.1)` - ç¢ºçŽ‡çš„å‹¾é…é™ä¸‹æ³•
- `adam(lr: 0.001)` - Adamã‚ªãƒ—ãƒ†ã‚£ãƒžã‚¤ã‚¶
- `adamw(lr: 0.001, weight_decay: 0.01)` - é‡ã¿æ¸›è¡°ä»˜ãAdamW

#### 6. ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œ

```bash
# TensorLogicã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
tl run your_script.tl

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
tl run your_script.tl --debug

# REPLï¼ˆå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼‰ã‚’èµ·å‹•
tl repl

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤º
tl --version

# ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
tl --help
```

### å®Œå…¨ãªä¾‹

å®Œå…¨ãªç·šå½¢å›žå¸°ã®ä¾‹ï¼ˆ[examples/tutorial_01_linear_regression.tl](examples/tutorial_01_linear_regression.tl)ï¼‰:

```tensorlogic
// å­¦ç¿’å¯èƒ½ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å®£è¨€
tensor w: float16[1] learnable = [0.5]
tensor b: float16[1] learnable = [0.5]

main {
    // ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°: æå¤±é–¢æ•°ã‚’æœ€å°åŒ–
    // Loss = w^2 + b^2 ï¼ˆw=0, b=0ã«åŽæŸï¼‰

    learn {
        objective: w * w + b * b,
        optimizer: sgd(lr: 0.1),
        epochs: 50
    }
}
```

å®Ÿè¡Œ:
```bash
tl run examples/tutorial_01_linear_regression.tl
```

### ãã®ä»–ã®ä¾‹

- [ã‚·ãƒ³ãƒ—ãƒ«ãªç·šå½¢ãƒ¢ãƒ‡ãƒ«](examples/simple_linear_model.tl) - ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã‚’ä½¿ã£ãŸãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã¨æŽ¨è«–ã®ä¾‹
- [ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«01: ç·šå½¢å›žå¸°](examples/tutorial_01_linear_regression.tl) - åŸºæœ¬çš„ãªæœ€é©åŒ–
- [ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«02: è¤‡æ•°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–](examples/tutorial_02_logistic_regression.tl) - è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- [ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«03: ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é‡ã¿](examples/tutorial_03_neural_network.tl) - é‡ã¿æ­£å‰‡åŒ–
- [ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«04: è«–ç†ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°](examples/tutorial_04_logic_programming.tl) - ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒ»ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯çµ±åˆ
- [ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ](examples/import_test/) - å¾ªç’°ä¾å­˜æ¤œå‡ºä»˜ãå¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- [å…¥é–€ã‚¬ã‚¤ãƒ‰](claudedocs/getting_started.md) - åŒ…æ‹¬çš„ãªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
- [è¨€èªžãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](docs/ja/language_reference.md) - å®Œå…¨ãªæ§‹æ–‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

## Pythonçµ±åˆ ðŸ

TensorLogicã¯ã€NumPyã€PyTorchã€SciKit-Learnãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«çµ±åˆã§ãã¾ã™ã€‚

### Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```tensorlogic
main {
    // Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ä»˜ãã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
    python import numpy as np
    python import torch
    python import sklearn.preprocessing as preprocessing
}
```

### Pythoné–¢æ•°ã®å‘¼ã³å‡ºã—

```tensorlogic
main {
    python import numpy as np

    // TensorLogicãƒ†ãƒ³ã‚½ãƒ«ã‚’ä½œæˆ
    tensor x: float16[3] = [1.0, 2.0, 3.0]
    tensor y: float16[3] = [4.0, 5.0, 6.0]

    // NumPyé–¢æ•°ã‚’å‘¼ã³å‡ºã—
    tensor sum_result: float16[3] = python.call("np.add", x, y)
    tensor mean_x: float16[1] = python.call("np.mean", x)
    tensor max_y: float16[1] = python.call("np.max", y)

    print("åŠ ç®—:", sum_result)   // [5.0, 7.0, 9.0]
    print("å¹³å‡:", mean_x)        // [2.0]
    print("æœ€å¤§:", max_y)          // [6.0]
}
```

### Tensor â†” NumPyå¤‰æ›

TensorLogicã¯f16ãƒ†ãƒ³ã‚½ãƒ«ã¨NumPyé…åˆ—ã‚’è‡ªå‹•å¤‰æ›ã—ã¾ã™:

- **TensorLogic â†’ NumPy**: f16 â†’ f32ï¼ˆã‚ãšã‹ãªç²¾åº¦æå¤±ï¼‰
- **NumPy â†’ TensorLogic**: f32/f64 â†’ f16
- GPUãƒ†ãƒ³ã‚½ãƒ«ã¯å¤‰æ›ã®ãŸã‚è‡ªå‹•çš„ã«CPUã«ç§»å‹•

### Pythonã‹ã‚‰ä½¿ç”¨

```python
import tensorlogic as tl
import numpy as np

# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ã‚’ä½œæˆ
interp = tl.Interpreter()

# Pythonçµ±åˆã‚’ä½¿ã£ã¦TensorLogicã‚’å®Ÿè¡Œ
code = """
main {
    python import numpy as np

    tensor data: float16[5] = [1.0, 2.0, 3.0, 4.0, 5.0]
    tensor normalized: float16[5] = python.call("preprocessing.normalize", data)

    print("æ­£è¦åŒ–æ¸ˆã¿:", normalized)
}
"""

interp.execute(code)
```

è©³ç´°ãªä¾‹ã«ã¤ã„ã¦ã¯ã€[examples/python_integration_test.tl](examples/python_integration_test.tl)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## Jupyter Notebookã‚µãƒãƒ¼ãƒˆ ðŸ“Š

TensorLogicã«ã¯ã€JupyterãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§ã®å¯¾è©±çš„é–‹ç™ºã®ãŸã‚ã®Jupyterã‚«ãƒ¼ãƒãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# TensorLogic Jupyterã‚«ãƒ¼ãƒãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
jupyter kernelspec install --user jupyter/tensorlogic

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç¢ºèª
jupyter kernelspec list
```

### ä½¿ã„æ–¹

1. **Jupyterã‚’èµ·å‹•**:
```bash
jupyter notebook
# ã¾ãŸã¯
jupyter lab
```

2. **æ–°ã—ã„ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆ**ã—ã€ã‚«ãƒ¼ãƒãƒ«ã¨ã—ã¦ã€ŒTensorLogicã€ã‚’é¸æŠž

3. **ã‚»ãƒ«ã«TensorLogicã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°**:

```tensorlogic
// ã‚»ãƒ«1: ãƒ†ãƒ³ã‚½ãƒ«ã‚’å®£è¨€
tensor W: float16[1] learnable = [0.5]
```

```tensorlogic
// ã‚»ãƒ«2: ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
tensor x: float16[1] = [2.0]
tensor y: float16[1] = [6.0]

learn {
    pred := x * W
    loss := (pred - y) * (pred - y)

    objective: loss,
    optimizer: sgd(lr: 0.1),
    epochs: 50
}

print("ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ¸ˆã¿W:", W)  // ~3.0ã«ãªã‚‹ã¯ãš
```

4. **`Shift+Enter`ã§ã‚»ãƒ«ã‚’å®Ÿè¡Œ**

### æ©Ÿèƒ½

- **å¯¾è©±çš„å®Ÿè¡Œ**: TensorLogicã‚³ãƒ¼ãƒ‰ã‚’ã‚»ãƒ«ã”ã¨ã«å®Ÿè¡Œ
- **å¤‰æ•°ã®æ°¸ç¶šæ€§**: ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§ã‚»ãƒ«é–“ã§å¤‰æ•°ãŒæ°¸ç¶šåŒ–
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡ºåŠ›**: ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®é€²è¡ŒçŠ¶æ³ã¨çµæžœã‚’å³åº§ã«ç¢ºèª
- **æ··åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**: ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†/å¯è¦–åŒ–ã®ãŸã‚ã«Pythonã‚»ãƒ«ã¨çµ„ã¿åˆã‚ã›

### ã‚µãƒ³ãƒ—ãƒ«ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯

å®Œå…¨ãªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«ã¤ã„ã¦ã¯ã€[examples/jupyter_tutorial.ipynb](examples/jupyter_tutorial.ipynb)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ‡ãƒã‚¤ã‚¹éšŽå±¤

```
Device
â”œâ”€â”€ Metal GPU (MTLDevice)
â”‚   â”œâ”€â”€ MetalBuffer (f16å…±æœ‰ãƒ¡ãƒ¢ãƒª)
â”‚   â”œâ”€â”€ KernelExecutor (ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥)
â”‚   â””â”€â”€ Compute Shaders (.metalãƒ•ã‚¡ã‚¤ãƒ«)
â”œâ”€â”€ Neural Engine (CoreML)
â”‚   â”œâ”€â”€ NeuralEngineBuffer (MLMultiArrayãƒ©ãƒƒãƒ‘ãƒ¼)
â”‚   â”œâ”€â”€ NeuralEngineOps (matmul, relu)
â”‚   â””â”€â”€ ãƒ¢ãƒ‡ãƒ«çµ±åˆï¼ˆå°†æ¥ï¼‰
â””â”€â”€ CPU (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯)
    â””â”€â”€ f16æ¼”ç®—
```

### æ¼”ç®—ãƒ•ãƒ­ãƒ¼

1. **ä½œæˆ**: ãƒ†ãƒ³ã‚½ãƒ«ã¯Metal GPUã¾ãŸã¯CPUä¸Šã§ä½œæˆ
2. **è¨ˆç®—**: æ¼”ç®—ã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã‚’ä»‹ã—ã¦Metal GPUä¸Šã§å®Ÿè¡Œ
3. **å¤‰æ›**: ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªMetal â†” Neural Engineãƒãƒƒãƒ•ã‚¡å¤‰æ›
4. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„æ¼”ç®—ã®è‡ªå‹•CPUãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

## ãƒ†ã‚¹ãƒˆã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹

### ãƒ†ã‚¹ãƒˆçµæžœ

**286/286 ãƒ†ã‚¹ãƒˆåˆæ ¼** âœ… ï¼ˆ`--test-threads=1`ä½¿ç”¨æ™‚ï¼‰

- ãƒ‘ãƒ¼ã‚µãƒ¼: 18ãƒ†ã‚¹ãƒˆï¼ˆã™ã¹ã¦ã®6ã‚¿ã‚¤ãƒ—: float16, int16, int32, int64, bool, complex16ï¼‰
- åž‹ãƒã‚§ãƒƒã‚«ãƒ¼: 20ãƒ†ã‚¹ãƒˆ
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿: 45ãƒ†ã‚¹ãƒˆ
- ãƒ†ãƒ³ã‚½ãƒ«æ¼”ç®—: 95ãƒ†ã‚¹ãƒˆ
- è‡ªå‹•å¾®åˆ†: 32ãƒ†ã‚¹ãƒˆ
- æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : 27ãƒ†ã‚¹ãƒˆï¼ˆSGDã€Adamã€AdamW + ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ï¼‰
- CoreMLçµ±åˆ: 16ãƒ†ã‚¹ãƒˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ: 10ãƒ†ã‚¹ãƒˆ
- GPUæ¼”ç®—: 23ãƒ†ã‚¹ãƒˆ

**é‡è¦**: Metal GPUãƒ†ã‚¹ãƒˆã¯ç«¶åˆçŠ¶æ…‹ã‚’é¿ã‘ã‚‹ãŸã‚ã«ã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ¬ãƒƒãƒ‰å®Ÿè¡ŒãŒå¿…è¦ã§ã™:

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆGPUãƒ†ã‚¹ãƒˆã«å¿…è¦ï¼‰
cargo test --lib -- --test-threads=1

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
cargo test --lib test_name -- --test-threads=1
```

**æ³¨æ„**: `--test-threads=1`ãªã—ã§ã¯ã€ä¸€éƒ¨ã®GPUãƒ†ã‚¹ãƒˆãŒåŒæ™‚Metalãƒªã‚½ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã«ã‚ˆã‚Šå¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯äºˆæœŸã•ã‚Œã‚‹å‹•ä½œã§ã‚ã‚Šã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè‡ªä½“ã®ãƒã‚°ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚µãƒãƒ¼ãƒˆ

- **Apple M4 Pro** ï¼ˆä¸»è¦é–‹ç™ºç’°å¢ƒï¼‰
- **Apple M1/M2/M3** ï¼ˆäº’æ›æ€§ã‚ã‚Šï¼‰
- macOS 13+ï¼ˆNeural Engineæ©Ÿèƒ½ç”¨ï¼‰
- ã™ã¹ã¦ã®æ¼”ç®—ã¯æœ€é©ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã®ãŸã‚ã«f16ã‚’ä½¿ç”¨

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒ©ã‚¤ã‚»ãƒ³ã‚¹:

- Apache License, Version 2.0 ([LICENSE-APACHE](LICENSE-APACHE) ã¾ãŸã¯ http://www.apache.org/licenses/LICENSE-2.0)
- MIT license ([LICENSE-MIT](LICENSE-MIT) ã¾ãŸã¯ http://opensource.org/licenses/MIT)

ãŠå¥½ã¿ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’é¸æŠžã§ãã¾ã™ã€‚

## è¬è¾ž

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä»¥ä¸‹ã«ã‚¤ãƒ³ã‚¹ãƒ‘ã‚¤ã‚¢ã•ã‚Œã¾ã—ãŸ:
- **[Andrej Karpathyã®ã€ŒIntro to Large Language Modelsã€](https://www.youtube.com/watch?v=rkBLPYqPkP4)** - åŠ¹çŽ‡çš„ãªãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«è¨ˆç®—ã¨æœ€é©åŒ–ã«é–¢ã™ã‚‹æ´žå¯Ÿ
- **[Tensor-Logicè«–æ–‡ï¼ˆarXiv:2510.12269ï¼‰](https://arxiv.org/abs/2510.12269)** - ãƒ†ãƒ³ã‚½ãƒ«ä»£æ•°ã¨è«–ç†ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’çµ±åˆã™ã‚‹ãŸã‚ã®ç†è«–çš„åŸºç¤Ž

[Claude Code](https://claude.com/claude-code)ã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰:
- GPUåŠ é€Ÿã®ãŸã‚ã®Appleã®Metalãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- Neural Engineçµ±åˆã®ãŸã‚ã®Appleã®CoreML
- Rustã®å„ªã‚ŒãŸåž‹ã‚·ã‚¹ãƒ†ãƒ ã¨å®‰å…¨æ€§ä¿è¨¼

## é€£çµ¡å…ˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ³ãƒ†ãƒŠ: Jun Suzuki
- GitHub: [@JunSuzukiJapan](https://github.com/JunSuzukiJapan)

---

**æ³¨æ„**: ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯Apple Siliconå‘ã‘ã«æœ€é©åŒ–ã•ã‚Œã¦ãŠã‚Šã€macOSãŒå¿…è¦ã§ã™ã€‚Neural Engineæ©Ÿèƒ½ã«ã¯macOS 13+ã¾ãŸã¯iOS 16+ãŒå¿…è¦ã§ã™ã€‚
