// Test large matrix initialization bug

main {
    print("Testing matrix initialization sizes")
    print("")

    // Test 4x4 matrix (should work)
    print("4x4 matrix:")
    tensor M4x4: float16[4, 4] = [[0.5, 0.3, 0.2, 0.1],
                                   [0.3, 0.5, 0.4, 0.2],
                                   [0.2, 0.4, 0.5, 0.3],
                                   [0.1, 0.2, 0.3, 0.5]]
    print("  Row 0:", [M4x4[0, 0], M4x4[0, 1], M4x4[0, 2], M4x4[0, 3]])
    print("")

    // Test 8x8 matrix
    print("8x8 matrix:")
    tensor M8x8: float16[8, 8] = [[0.5, 0.3, 0.2, 0.1, 0.4, 0.6, 0.2, 0.3],
                                   [0.3, 0.5, 0.4, 0.2, 0.1, 0.3, 0.5, 0.4],
                                   [0.2, 0.4, 0.5, 0.3, 0.2, 0.1, 0.4, 0.5],
                                   [0.1, 0.2, 0.3, 0.5, 0.4, 0.2, 0.1, 0.3],
                                   [0.4, 0.1, 0.2, 0.4, 0.5, 0.3, 0.2, 0.1],
                                   [0.6, 0.3, 0.1, 0.2, 0.3, 0.5, 0.4, 0.2],
                                   [0.2, 0.5, 0.4, 0.1, 0.2, 0.4, 0.5, 0.3],
                                   [0.3, 0.4, 0.5, 0.3, 0.1, 0.2, 0.3, 0.5]]
    print("  Row 0:", [M8x8[0, 0], M8x8[0, 1], M8x8[0, 2], M8x8[0, 3]])
    print("")

    // Test 16x16 matrix (this triggers the bug)
    print("16x16 matrix:")
    tensor M16x16: float16[16, 16] = [
        [0.5, 0.3, 0.2, 0.1, 0.4, 0.6, 0.2, 0.3, 0.5, 0.3, 0.2, 0.1, 0.4, 0.6, 0.2, 0.3],
        [0.3, 0.5, 0.4, 0.2, 0.1, 0.3, 0.5, 0.4, 0.3, 0.5, 0.4, 0.2, 0.1, 0.3, 0.5, 0.4],
        [0.2, 0.4, 0.5, 0.3, 0.2, 0.1, 0.4, 0.5, 0.2, 0.4, 0.5, 0.3, 0.2, 0.1, 0.4, 0.5],
        [0.1, 0.2, 0.3, 0.5, 0.4, 0.2, 0.1, 0.3, 0.1, 0.2, 0.3, 0.5, 0.4, 0.2, 0.1, 0.3],
        [0.4, 0.1, 0.2, 0.4, 0.5, 0.3, 0.2, 0.1, 0.4, 0.1, 0.2, 0.4, 0.5, 0.3, 0.2, 0.1],
        [0.6, 0.3, 0.1, 0.2, 0.3, 0.5, 0.4, 0.2, 0.6, 0.3, 0.1, 0.2, 0.3, 0.5, 0.4, 0.2],
        [0.2, 0.5, 0.4, 0.1, 0.2, 0.4, 0.5, 0.3, 0.2, 0.5, 0.4, 0.1, 0.2, 0.4, 0.5, 0.3],
        [0.3, 0.4, 0.5, 0.3, 0.1, 0.2, 0.3, 0.5, 0.3, 0.4, 0.5, 0.3, 0.1, 0.2, 0.3, 0.5],
        [0.5, 0.3, 0.2, 0.1, 0.4, 0.6, 0.2, 0.3, 0.5, 0.3, 0.2, 0.1, 0.4, 0.6, 0.2, 0.3],
        [0.3, 0.5, 0.4, 0.2, 0.1, 0.3, 0.5, 0.4, 0.3, 0.5, 0.4, 0.2, 0.1, 0.3, 0.5, 0.4],
        [0.2, 0.4, 0.5, 0.3, 0.2, 0.1, 0.4, 0.5, 0.2, 0.4, 0.5, 0.3, 0.2, 0.1, 0.4, 0.5],
        [0.1, 0.2, 0.3, 0.5, 0.4, 0.2, 0.1, 0.3, 0.1, 0.2, 0.3, 0.5, 0.4, 0.2, 0.1, 0.3],
        [0.4, 0.1, 0.2, 0.4, 0.5, 0.3, 0.2, 0.1, 0.4, 0.1, 0.2, 0.4, 0.5, 0.3, 0.2, 0.1],
        [0.6, 0.3, 0.1, 0.2, 0.3, 0.5, 0.4, 0.2, 0.6, 0.3, 0.1, 0.2, 0.3, 0.5, 0.4, 0.2],
        [0.2, 0.5, 0.4, 0.1, 0.2, 0.4, 0.5, 0.3, 0.2, 0.5, 0.4, 0.1, 0.2, 0.4, 0.5, 0.3],
        [0.3, 0.4, 0.5, 0.3, 0.1, 0.2, 0.3, 0.5, 0.3, 0.4, 0.5, 0.3, 0.1, 0.2, 0.3, 0.5]
    ]
    print("  Row 0:", [M16x16[0, 0], M16x16[0, 1], M16x16[0, 2], M16x16[0, 3]])
    print("  Expected: [0.5, 0.3, 0.2, 0.1]")
    print("")

    print("Test complete")
}
